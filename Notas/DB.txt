-- Tabela de Usuários
CREATE TABLE usuario (
    id_user INT PRIMARY KEY AUTO_INCREMENT,
    nome_user VARCHAR(100) NOT NULL,
    username_user VARCHAR(20) UNIQUE NOT NULL,
    email_user VARCHAR(100) UNIQUE NOT NULL,
    criado_user DATETIME DEFAULT CURRENT_TIMESTAMP  
);

-- Tabela Escola
CREATE TABLE escola (
    id_escola INT PRIMARY KEY AUTO_INCREMENT,
    nome_escola VARCHAR(150) NOT NULL,
    categoria_escola ENUM('publica', 'privada') NOT NULL,
    uf_escola CHAR(2) NOT NULL,
    bairro_escola VARCHAR(100) NOT NULL,
);

-- Tabela Publicacao (atualizada)
CREATE TABLE publicacao (
    id_publi INT PRIMARY KEY AUTO_INCREMENT,
    id_user INT NOT NULL,
    id_escola INT NOT NULL, 
    titulo_publi VARCHAR(200) NOT NULL,
    texto_publi TEXT NOT NULL,
    data_publi DATETIME DEFAULT CURRENT_TIMESTAMP,
    resolvido_publi BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (id_user) REFERENCES usuario(id_user),
    FOREIGN KEY (id_escola) REFERENCES escola(id_escola),
    INDEX idx_user (id_user),
    INDEX idx_escola (id_escola)
);

-- Tabela de Comentários
CREATE TABLE comentario (
    id_coment INT PRIMARY KEY AUTO_INCREMENT,
    id_publi INT NOT NULL,
    id_user INT NOT NULL,
    texto_coment TEXT NOT NULL,
    data_coment DATETIME DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (id_publi) REFERENCES publicacao(id_publi) ON DELETE CASCADE,
    FOREIGN KEY (id_user) REFERENCES usuario(id_user),
    INDEX idx_publicacao (id_publi),  
    INDEX idx_user (id_user)           
);